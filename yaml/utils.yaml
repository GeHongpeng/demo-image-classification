kind: job
metadata:
  name: file-utils
  tag: ''
  hash: d8a77a67bfe0f8054f6d9a3cec35bde985e91c7d
  project: ''
spec:
  command: ''
  args: []
  image: .mlrun/func-default-file-utils-latest
  env:
  - name: V3IO_API
    value: ''
  - name: V3IO_USERNAME
    value: ''
  - name: V3IO_ACCESS_KEY
    value: ''
  description: ''
  build:
    functionSourceCode: IyBHZW5lcmF0ZWQgYnkgbnVjbGlvLmV4cG9ydC5OdWNsaW9FeHBvcnRlciBvbiAyMDIwLTAyLTI3IDE3OjExCgppbXBvcnQgb3MKaW1wb3J0IHppcGZpbGUKaW1wb3J0IGpzb24KZnJvbSB0ZW1wZmlsZSBpbXBvcnQgbWt0ZW1wCmltcG9ydCBwYW5kYXMgYXMgcGQKCgpkZWYgb3Blbl9hcmNoaXZlKGNvbnRleHQsIAogICAgICAgICAgICAgICAgIHRhcmdldF9kaXI9J2NvbnRlbnQnLAogICAgICAgICAgICAgICAgIGFyY2hpdmVfdXJsPScnKToKICAgICIiIk9wZW4gYSBmaWxlL29iamVjdCBhcmNoaXZlIGludG8gYSB0YXJnZXQgZGlyZWN0b3J5IiIiCiAgICAgICAgCiAgICBvcy5tYWtlZGlycyh0YXJnZXRfZGlyLCBleGlzdF9vaz1UcnVlKQogICAgY29udGV4dC5sb2dnZXIuaW5mbygnVmVyaWZpZWQgZGlyZWN0b3JpZXMnKQogICAgCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKCdFeHRyYWN0aW5nIHppcCcpCiAgICB6aXBfcmVmID0gemlwZmlsZS5aaXBGaWxlKGFyY2hpdmVfdXJsLCAncicpCiAgICB6aXBfcmVmLmV4dHJhY3RhbGwodGFyZ2V0X2RpcikKICAgIHppcF9yZWYuY2xvc2UoKQogICAgCiAgICBjb250ZXh0LmxvZ2dlci5pbmZvKGYnZXh0cmFjdGVkIGFyY2hpdmUgdG8ge3RhcmdldF9kaXJ9JykKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCdjb250ZW50JywgdGFyZ2V0X3BhdGg9dGFyZ2V0X2RpcikKCiAgICAKZnJvbSBtbHJ1bi5hcnRpZmFjdHMgaW1wb3J0IFRhYmxlQXJ0aWZhY3QKCmRlZiBjYXRlZ29yaWVzX21hcF9idWlsZGVyKGNvbnRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZV9kaXIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmX2ZpbGVuYW1lPSdmaWxlX2NhdGVnb3JpZXNfZGYuY3N2JywKICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFwX2ZpbGVuYW1lPSdjYXRlZ29yaWVzX21hcC5qc29uJyk6CiAgICAiIiJSZWFkIGxhYmVsZWQgaW1hZ2VzIGZyb20gYSBkaXJlY3RvcnkgYW5kIGNyZWF0ZSBjYXRlZ29yeSBtYXAgKyBkZgogICAgCiAgICBmaWxlbmFtZSBmb3JtYXQ6IDxjYXRlZ29yeT4uTk4uanBnIiIiCiAgICAKICAgIGZpbGVuYW1lcyA9IFtmaWxlIGZvciBmaWxlIGluIG9zLmxpc3RkaXIoc291cmNlX2RpcikgaWYgZmlsZS5lbmRzd2l0aCgnLmpwZycpXQogICAgY2F0ZWdvcmllcyA9IFtdCiAgICAgICAgCiAgICBmb3IgZmlsZW5hbWUgaW4gZmlsZW5hbWVzOgogICAgICAgIGNhdGVnb3J5ID0gZmlsZW5hbWUuc3BsaXQoJy4nKVswXQogICAgICAgIGNhdGVnb3JpZXMuYXBwZW5kKGNhdGVnb3J5KQoKICAgIGRmID0gcGQuRGF0YUZyYW1lKHsKICAgICAgICAnZmlsZW5hbWUnOiBmaWxlbmFtZXMsCiAgICAgICAgJ2NhdGVnb3J5JzogY2F0ZWdvcmllcwogICAgfSkKICAgIGRmWydjYXRlZ29yeSddID0gZGZbJ2NhdGVnb3J5J10uYXN0eXBlKCdzdHInKQogICAgCiAgICBjYXRlZ29yaWVzID0gZGYuY2F0ZWdvcnkudW5pcXVlKCkKICAgIGNhdGVnb3JpZXMgPSB7aTogY2F0ZWdvcnkgZm9yIGksIGNhdGVnb3J5IGluIGVudW1lcmF0ZShjYXRlZ29yaWVzKX0KICAgIHdpdGggb3Blbihvcy5wYXRoLmpvaW4oY29udGV4dC5vdXRfcGF0aCwgbWFwX2ZpbGVuYW1lKSwgJ3cnKSBhcyBmOgogICAgICAgIGYud3JpdGUoanNvbi5kdW1wcyhjYXRlZ29yaWVzKSkKICAgICAgICAKICAgIGNvbnRleHQubG9nZ2VyLmluZm8oY2F0ZWdvcmllcykKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KCdjYXRlZ29yaWVzX21hcCcsIHNyY19wYXRoPW1hcF9maWxlbmFtZSkKICAgIGNvbnRleHQubG9nX2FydGlmYWN0KFRhYmxlQXJ0aWZhY3QoJ2ZpbGVfY2F0ZWdvcmllcycsIGRmPWRmLCBzcmNfcGF0aD1kZl9maWxlbmFtZSkpCgo=
    image: .mlrun/func-default-file-utils-latest
    commands: []
    code_origin: https://github.com/mlrun/demo-image-classification#7f9273e18864ada4385667e6c59e379f6f18e541:../src/utils.py
